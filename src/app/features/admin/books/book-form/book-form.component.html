<h2>{{ id ? 'Edit Book' : 'New Book' }}</h2>

<form (ngSubmit)="save()" *ngIf="!loading">
  <label>Title <input [(ngModel)]="model.title" name="title" required /></label>
  <label>Description <textarea [(ngModel)]="model.description" name="description"></textarea></label>
  <div class="row">
    <label>Price <input type="number" step="0.01" [(ngModel)]="model.price" name="price" /></label>
    <label>Stock <input type="number" [(ngModel)]="model.stock" name="stock" /></label>
  </div>

  <div class="row">
    <label>Author
      <select [(ngModel)]="model.authorId" name="authorId" required>
        <option [ngValue]="null">-- Choose --</option>
        <option *ngFor="let a of authors" [ngValue]="a.id">{{ a.name }}</option>
      </select>
    </label>

    <label>Category
      <select [(ngModel)]="model.categoryId" name="categoryId" required>
        <option [ngValue]="null">-- Choose --</option>
        <option *ngFor="let c of categories" [ngValue]="c.id">{{ c.name }}</option>
      </select>
    </label>
  </div>

  <fieldset>
    <legend>Cover Image</legend>
    <label>Upload file <input type="file" (change)="onFile($event)" /></label>
    <span>or</span>
    <label>Image URL <input [(ngModel)]="model.imageUrl" name="imageUrl" placeholder="https://..." /></label>
  </fieldset>

  <button type="submit">Save</button>
  <a routerLink="/admin/books">Cancel</a>
</form>

<p *ngIf="loading">Loading...</p>
